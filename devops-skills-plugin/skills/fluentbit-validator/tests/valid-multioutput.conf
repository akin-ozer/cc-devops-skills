# Valid configuration with multiple outputs

[SERVICE]
    Flush               5
    Daemon              Off
    Log_Level           info
    HTTP_Server         On
    HTTP_Port           2020
    storage.metrics     on

[INPUT]
    Name              tail
    Path              /var/log/app/*.log
    Tag               app.logs
    Mem_Buf_Limit     50MB
    DB                /var/log/flb-app.db
    Skip_Long_Lines   On

[FILTER]
    Name         grep
    Match        app.*
    Regex        level (ERROR|WARN)

[FILTER]
    Name         modify
    Match        app.*
    Add          environment production
    Add          cluster main

[OUTPUT]
    Name                elasticsearch
    Match               app.*
    Host                ${ES_HOST}
    Port                9200
    HTTP_User           ${ES_USER}
    HTTP_Passwd         ${ES_PASSWORD}
    Logstash_Format     On
    Retry_Limit         5
    tls                 On
    tls.verify          On
    storage.total_limit_size 5G

[OUTPUT]
    Name                loki
    Match               app.*
    Host                ${LOKI_HOST}
    Port                3100
    labels              job=fluentbit, environment=production
    line_format         json
    Retry_Limit         3
    tls                 On